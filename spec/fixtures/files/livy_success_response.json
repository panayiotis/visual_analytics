{
  "id": 61,
  "code": "print(s\"\"\"{\n  \"schema\": ${spark.sql(\"SELECT * FROM view\").schema.json},\n  \"data\": [\n    ${spark.sql(\"SELECT view.nuts_1 AS nuts, view.date_year AS date, view.reported_by AS reported_by, view.crime_type_level_2 AS crime_type, COUNT(*) AS count FROM view WHERE view.nuts_0 = 'UK' AND view.nuts_2 = 'UKI6' AND view.date_year = '2016-01-01' GROUP BY view.nuts_1, view.date_year, view.reported_by, view.crime_type_level_2\").coalesce(1).toJSON.collect().mkString(\",\\n\")}\n  ]\n}\"\"\")\n",
  "state": "available",
  "output": {
    "status": "ok",
    "execution_count": 61,
    "data": {
      "text/plain": "{\n  \"schema\": {\"type\":\"struct\",\"fields\":[{\"name\":\"reported_by\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"falls_within\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"crime_type_level_2\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_outcome_category\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"date_month\",\"type\":\"date\",\"nullable\":true,\"metadata\":{}},{\"name\":\"nuts_3\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"nuts_2\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"nuts_1\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"nuts_0\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"quarter\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"date_year\",\"type\":\"date\",\"nullable\":true,\"metadata\":{}},{\"name\":\"crime_type_level_1\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\n  \"data\": [\n    {\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Criminal damage and arson\",\"count\":551},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Derbyshire Constabulary\",\"crime_type\":\"Violence and sexual offences\",\"count\":3},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Other crime\",\"count\":98},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Robbery\",\"count\":2080},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Kent Police\",\"crime_type\":\"Robbery\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Possession of weapons\",\"count\":454},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Sussex Police\",\"crime_type\":\"Other theft\",\"count\":2},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Drugs\",\"count\":4},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Northamptonshire Police\",\"crime_type\":\"Other crime\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Public order\",\"count\":5217},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Robbery\",\"count\":34},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Kent Police\",\"crime_type\":\"Other theft\",\"count\":3},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Kent Police\",\"crime_type\":\"Vehicle crime\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Suffolk Constabulary\",\"crime_type\":\"Violence and sexual offences\",\"count\":4},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Drugs\",\"count\":3152},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Gwent Police\",\"crime_type\":\"Violence and sexual offences\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Suffolk Constabulary\",\"crime_type\":\"Drugs\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Kent Police\",\"crime_type\":\"Shoplifting\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Violence and sexual offences\",\"count\":24767},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Vehicle crime\",\"count\":9665},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Shoplifting\",\"count\":323},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Theft from the person\",\"count\":40},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Anti-social behaviour\",\"count\":38},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Nottinghamshire Police\",\"crime_type\":\"Violence and sexual offences\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Violence and sexual offences\",\"count\":26},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Robbery\",\"count\":2},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Drugs\",\"count\":107},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Criminal damage and arson\",\"count\":7},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Kent Police\",\"crime_type\":\"Burglary\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Theft from the person\",\"count\":15},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Bicycle theft\",\"count\":1137},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Avon and Somerset Constabulary\",\"crime_type\":\"Violence and sexual offences\",\"count\":4},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Other theft\",\"count\":9455},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Anti-social behaviour\",\"count\":1686},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Sussex Police\",\"crime_type\":\"Burglary\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Bicycle theft\",\"count\":15},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Other crime\",\"count\":1071},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Burglary\",\"count\":8281},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Sussex Police\",\"crime_type\":\"Violence and sexual offences\",\"count\":2},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Possession of weapons\",\"count\":32},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Vehicle crime\",\"count\":7},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Public order\",\"count\":30},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Bicycle theft\",\"count\":123},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Kent Police\",\"crime_type\":\"Criminal damage and arson\",\"count\":4},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Other theft\",\"count\":22},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Kent Police\",\"crime_type\":\"Violence and sexual offences\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Possession of weapons\",\"count\":2},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Shoplifting\",\"count\":5684},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Anti-social behaviour\",\"count\":25469},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Public order\",\"count\":463},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Other theft\",\"count\":545},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Theft from the person\",\"count\":1459},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Vehicle crime\",\"count\":520},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Kent Police\",\"crime_type\":\"Public order\",\"count\":1},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"British Transport Police\",\"crime_type\":\"Shoplifting\",\"count\":4},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Metropolitan Police Service\",\"crime_type\":\"Criminal damage and arson\",\"count\":8922},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Violence and sexual offences\",\"count\":1376},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Surrey Police\",\"crime_type\":\"Burglary\",\"count\":434},\n{\"nuts\":\"UKI\",\"date\":\"2016-01-01\",\"reported_by\":\"Essex Police\",\"crime_type\":\"Violence and sexual offences\",\"count\":3}\n  ]\n}"
    }
  },
  "progress": 1.0
}